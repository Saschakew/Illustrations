<h2>Recovering Structural Shocks with Identifying Restrictions</h2>

<div id="estimation-controls" class="controls-container card mb-4">
    <div class="card-body">
        <div class="controls-row">
            <!-- Phi Slider (left) -->
            <div class="control-item sample-size">
                <label for="phiSlider_er" class="form-label mb-0 me-2">\( \phi = \)<span id="phiValue_er">0.00</span></label>
                <input type="range" class="form-range" min="0" max="1.5708" step="0.01" id="phiSlider_er" value="0" data-id="phi-slider">
            </div>

            <!-- B0 Toggle (middle) -->
            <div class="control-item phi-toggle">
                <div class="phi-toggle-pill">
                    <span class="phi-label phi-label-left" id="phiLabel0_er">Recursive</span>
                    <label class="custom-switch">
                        <input type="checkbox" id="b0Switch_er" title="Switch between Recursive and Non-recursive true B_0">
                        <span class="slider"></span>
                    </label>
                    <span class="phi-label phi-label-right" id="phiLabelPi_er">Non-recursive</span>
                </div>
            </div>

            <!-- New Sample Button (right) -->
            <div class="control-item new-sample">
                <button id="newSampleBtn_er" class="btn w-100">New Sample</button>
            </div>
        </div>
    </div>
</div>

<div id="controls-placeholder-er"></div>

<div class="explanation-container card mb-4">
    <div class="card-body">
        <p>
            We observe reduced-form shocks \(u_t\) and seek to recover the unobserved structural shocks \(\epsilon_t\). The relationship is \(\epsilon_t = B_0^{-1} u_t\), but the true matrix \(B_0\) is unknown.
        </p>
        <p>
            Define innovations \(e_t(B) = B^{-1} u_t\). Assuming structural shocks are uncorrelated and have unit variance (\(E[\epsilon_t \epsilon_t'] = I\)), we look for a matrix \(B\) such that the sample innovations \(e_t(B)\) also satisfy this property.
        </p>
        <p>
            The set of such matrices \(B\) can be parameterized by a single rotation angle \(\phi \in [0, \pi/2]\). 
            Specifically, all matrices \(B(\phi) = B^{\text{Chol}} Q(\phi)\) yield innovations with unit variance and uncorrelated shocks, where \(B^{\text{Chol}}\) is the Cholesky decomposition of the sample covariance of \(u_t\), and \(Q(\phi) = \begin{pmatrix} \cos\phi & -\sin\phi \\ \sin\phi & \cos\phi \end{pmatrix}\).
        </p>
        <p>Use the \(\phi  \) slider to select a rotation angle  and see the corresponding matrix   \(B(\phi = \) <span id="phiValueDisplay_er">0.00</span> \( ) = \) <span id="bMatrixDisplay_er"></span>. 
        </p>
         
        <p> Given the true data-generating matrix \(B_0\) (selected via the toggle), we can calculate the true rotation angle
        \(\phi_0\). For the recursive \(B_0\) we get \(\phi_0^{\text{rec}} = 0\). For the non-recursive \(B_0\) we get \(\phi_0^{\text{non-rec}}  \approx 0.7854\).
            The Cholesky identification imposes a recursive structure on \(B\) (e.g., its (1,2) element is zero), which uniquely determines the rotation angle as \(\phi=0\).
            Click the button below to see the results of this estimation.
           
        </p>
        <div class="text-center">
            <button id="estimateRecursiveBtn_er" class="btn btn-primary my-4">Estimate Recursive SVAR</button>
            <div id="estimationResults_er" class="mt-3" style="display: none;">
                <p>
                    Estimated \(\hat{\phi}\)= <span id="estimatedPhiValue_er"></span> leads to \(\hat{B}=\) <span id="estimatedB_er"></span> compared to the true \(B_0\)= <span id="trueB0_er"></span>.
                </p>
            </div>
        </div>
        <p>
        <strong>Observations:</strong>
        All \(B(\phi)\) yield uncorrelated innovations \(e_{1t}(\phi)\) and \(e_{2t}(\phi)\).
        The recursive estimator works well when the true model is recursive.
        The recursive estimator is biased when the true model is non-recursive.
        The bias does not vanish with an increasing sample size.
        </p>
    </div>
</div>

<div class="plot-wrapper">
    <div id="innovationsScatterPlot_er" class="plot-container-individual"></div>
    <div id="correlationPlot_er" class="plot-container-individual"></div>
</div>

<div>
    <ul>
        <li><strong>Left Plot (Innovations):</strong> A scatter plot of the calculated innovations \(e_{1t}(\phi)\) vs. \(e_{2t}(\phi)\) for the currently selected \(\phi\).</li>
        <li><strong>Right Plot (Sample Correlation):</strong> Shows the sample correlation, \(\text{mean}(e_{1t}(\phi) \cdot e_{2t}(\phi))\), across all possible values of \(\phi \in [0, \pi/2]\). A vertical line indicates the current \(\phi\). Another line marks \(\phi_0\) which corresponds to the true \(B_0\) which changes with the recursive vs non-recursive slider. </li>
    </ul>
</div>
